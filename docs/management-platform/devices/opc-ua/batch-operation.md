# 批量操作OPC UA设备

在工业现场，往往需要批量创建设备。WAGO VC Hub 通过**导出和导入**功能来实现这一功能。

**说明**：要想实现快速创建设备，建议先在列表中手动新增一条设备信息，之后将该设备进行导出，根据导出的字段信息添加新的设备。

#### 批量新增

###### 1.导出设备

点击列表右上角的“导出”按钮，可以将列表中的所有设备信息进行导出。

导出OPC UA设备时，会包含组的信息一起导出。

导出文件示例：

![alt text](23.png)

- 红框中内容为字段信息。
- 如果是设备，则“IsDevice”字段为True。
- 组信息紧跟在对应的设备下面。例如上图的设备“Device1”下，存在1个组，Group。

| **说明**：如果OPC UA设备使用**用户名，密码**进行身份验证，导出的时候**不包含**这两个字段。导入设备后，需手动为每个设备设置用户名和密码。 |
|------------------------------------------------------------------------------------------------------------------------------------|

###### 2.在Excel中新增设备

选中设备和组，拉动鼠标，完成快速复制。名称会递增。

![alt text](24.gif)

###### 3.导入设备

点击列表右上角的“导入”按钮，可以将导出的内容进行导入。导入后，新增的设备的启用状态默认为“已禁用”。

![alt text](25.png)

#### 批量修改

可以通过导出的excel，对设备信息进行批量修改。修改后将excel导入，导入时，将按照名称进行数据更新。

- Excel中的设备名称和OPC UA列表中的名称一致，则使用excel中的该条配置进行数据更新。
- Excel中的设备名称和设备下的组，与OPC UA列表中的一致，则使用excel中的该条配置进行数据更新。
- Excel中的设备名称或者组名称在OPC UA列表中不存在，则在列表中新增该设备和组。
- OPC UA列表中的设备，不存在于导入文件中，则导入后，列表中的该数据不受影响。

#### 批量删除

勾选需要删除的设备后，点击列表上方的删除按钮进行批量删除。

![alt text](26.png)

**说明：**

1. 已启用状态的设备不允许删除
2. 只能对当前页的数据进行删除，不支持跨页删除
3. 删除设备时，会连同组一起删除